
!!! PoC !!!
!!! VALIDATION OF SIMILIAR DEVICE FROM SAME IPV4 !!!
!!! Poc !!!


Situation:

Same source IP


Win 10 Home (Dell):

ja3:        771,4865-4866-4867-49195-49196-49199-49200-49171-49192-156-157-47-53-10,0-23-65281-10-11-35-16-13-51-45-43,29-23-24-25-25497-65074,0
ja4:        t13d1412h2_251dcffb97b3_6891fded7202
ja4h:       po20cr30ptbr_cb677efb3898_000000000000_000000000000
post:       e9cd5b30f5e3c68806d1c9607c51b47929070bbd26914bb3d1f457f5b46f8b7f
Content:    41
User-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0


Win 10 Pro (Sony Vaio):

ja3:        771,4865-4866-4867-49195-49196-49199-49200-49171-49192-156-157-47-53-10,0-23-65281-10-11-35-16-13-51-45-43,29-23-24-25-25497-65074,0
ja4:        t13d1412h2_251dcffb97b3_6891fded7202
ja4h:       po20cn30ptbr_cb677efb3898_000000000000_000000000000
post:       a97b91e5f8125071057194d6c2c1fc80ed29e8e8cb9c74b7d4d4a666620a1b6d
Content:    93
User-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0





Tests:




Cookie: 'insigniar_id=09f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f3909f59b557e692a8b9ab68d11abf6326c0bb044588fdee3f0a6f2895005976f39'



po20cr31enus_c68d3701adb7_000000000000_000000000000
po20cn31enus_c68d3701adb7_1d09e1d14fdc_098752c078a0



Field
1d09e1d14fdc

Field+Value
098752c078a0



### 

JWT
Sub-dominio do cliente
Cookie Domain
CORS

POST from the client to "client backend" -> Area51 Backend Set-cookie in response to "client backend" and back to the client browser

Area51 previously calculate the ja4h truncated hash for ja4h_c and ja4h_d

When client open the link do validate the device the Area51 backend will match the ja4h_c and ja4h_d with previously calculated values. 

Re-setting the cookie to expired.

###


# CORS
proxy_set_header Access-Control-Allow-Origin "*";
proxy_set_header Access-Control-Allow-Methods "GET, POST, OPTIONS";
proxy_set_header Access-Control-Allow-Headers "Origin, Authorization, Accept, Content-Type";
proxy_set_header Access-Control-Allow-Credentials true;



Others situations:



macOS 

ja3: 771,4865-4866-4867-49195-49196-49199-49200-49171-49192-156-157-47-53-10,0-23-65281-10-11-35-16-13-51-45-43,29-23-24-25-25497-65074,0
ja4:  t13d1412h2_251dcffb97b3_6891fded7202
ja4h: po20cr31enus_c68d3701adb7_000000000000_000000000000
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 OPR/109.0.0.0


iPhone

ja3: 771,4865-4866-4867-49195-49196-49199-49200-49171-49192-156-157-47-53-10,0-23-65281-10-11-35-16-13-51-45-43,29-23-24-25-25497-65074,0
ja4: t13d1412h2_251dcffb97b3_6891fded7202
ja4h: po20cr24engb_a380b3f63865_000000000000_000000000000
Mozilla/5.0 (iPhone; CPU iPhone OS 17_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 Version/17.4.1 Safari/605.1.15 AlohaBrowser/5.6.0


Android Emulado

ja3: 771,4865-4866-4867-49195-49196-49199-49200-49171-49192-156-157-47-53-10,0-23-65281-10-11-35-16-13-51-45-43,29-23-24-25-25497-65074,0
ja4: t13d1412h2_251dcffb97b3_6891fded7202
ja4h: po20cr30enus_cb677efb3898_000000000000_000000000000
Mozilla/5.0 (Linux; Android 14; sdk_gphone64_arm64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Mobile Safari/537.36




!!! PoC !!!
!!! VALIDATION OF SIMILIAR DEVICE FROM SAME IPV4 !!!
!!! Poc !!!


